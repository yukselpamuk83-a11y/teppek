import{j as e,r as t,c as l,R as s,S as a,A as r}from"./vendor-CAgRcyMx.js";function n({onFirmaLogin:t,onAdayLogin:l}){return e.jsxs("header",{className:"bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between z-[1000]",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-blue-600",children:"Teppek"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Global İş Platformu"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:t,className:"bg-ilan text-white px-6 py-2 rounded-lg hover:opacity-90 transition-all font-semibold",children:[e.jsx("i",{className:"fa-solid fa-building mr-2"}),"Firma Girişi"]}),e.jsxs("button",{onClick:l,className:"bg-cv text-white px-6 py-2 rounded-lg hover:opacity-90 transition-all font-semibold",children:[e.jsx("i",{className:"fa-solid fa-user mr-2"}),"Aday Girişi"]})]})]})}function i({isOpen:t,onClose:l,userType:s,title:a,color:r}){return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[2000]",children:e.jsxs("div",{className:"bg-white rounded-lg p-8 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:`text-2xl font-bold text-${"ilan"===r?"cyan":"orange"}-600`,children:a}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"×"})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("button",{className:"w-full bg-red-500 text-white py-3 px-4 rounded-lg hover:bg-red-600 transition-colors flex items-center justify-center font-semibold",children:[e.jsx("i",{className:"fab fa-google mr-3"}),"Google ile Giriş Yap"]}),e.jsxs("button",{className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center font-semibold",children:[e.jsx("i",{className:"fab fa-facebook mr-3"}),"Facebook ile Giriş Yap"]})]}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"veya"})})]}),e.jsxs("form",{className:"space-y-4",children:[e.jsx("input",{type:"email",placeholder:"E-posta adresiniz",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),e.jsx("input",{type:"password",placeholder:"Şifreniz",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0}),e.jsx("button",{type:"submit",className:`w-full bg-${r} text-white py-3 px-4 rounded-lg hover:opacity-90 transition-all font-semibold`,children:"Giriş Yap"})]}),e.jsxs("p",{className:"mt-6 text-center text-gray-600",children:["Hesabınız yok mu?",e.jsx("button",{className:`ml-1 text-${"ilan"===r?"cyan":"orange"}-600 hover:underline font-semibold`,children:"Kayıt Ol"})]})]})}):null}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const l of e)if("childList"===l.type)for(const e of l.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();let o;function c({data:l,selectedLocation:s,isSubscribed:a,userLocation:r,onPremiumClick:n}){const i=t.useRef(null),c=t.useRef(null),d=t.useRef(null),u=t.useRef(null),m=t.useRef(null),[x,p]=t.useState(null),g={street:{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},satellite:{url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri"}},h=t.useCallback(((e,t)=>{let l;return(...s)=>{clearTimeout(l),l=setTimeout(()=>e.apply(null,s),t)}})(e=>{c.current&&x&&c.current.removeLayer(x);const t=o.tileLayer(g[e].url,{attribution:g[e].attribution,noWrap:!0}).addTo(c.current);p(t)},150),[x]);t.useEffect(()=>{(async()=>{if(await(async()=>{var e;if("undefined"!=typeof window){if(["https://unpkg.com/leaflet@1.9.4/dist/leaflet.css","https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css","https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css"].forEach(e=>{try{if(!document.querySelector(`link[href="${e}"]`)){const t=document.createElement("link");t.rel="stylesheet",t.href=e,document.head&&document.head.appendChild(t)}}catch(t){}}),!window.L)try{await new Promise((e,t)=>{const l=document.createElement("script");l.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",l.onload=e,l.onerror=t,document.head?document.head.appendChild(l):t(new Error("Document head not available"))})}catch(t){return}if(!(null==(e=window.L)?void 0:e.markerClusterGroup))try{await new Promise((e,t)=>{const l=document.createElement("script");l.src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js",l.onload=e,l.onerror=t,document.head?document.head.appendChild(l):t(new Error("Document head not available"))})}catch(t){return}o=window.L,o.markerClusterGroup}})(),i.current&&!c.current&&o){c.current=o.map(i.current,{maxBounds:[[-90,-180],[90,180]],maxBoundsViscosity:1,minZoom:2,maxZoom:18}).setView([r.lat,r.lng],10);const e=o.tileLayer(g.street.url,{attribution:g.street.attribution,noWrap:!0,bounds:[[-90,-180],[90,180]]}).addTo(c.current);p(e),u.current=o.circle([r.lat,r.lng],{radius:5e4,color:"#3b82f6",fillColor:"#60a5fa",fillOpacity:.1,weight:1}).addTo(c.current),c.current&&c.current.fitBounds(u.current.getBounds()),d.current=o.markerClusterGroup({maxClusterRadius:50,spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,zoomToBoundsOnClick:!0}),c.current.addLayer(d.current),c.current.on("zoomend moveend",()=>{setTimeout(()=>{d.current&&d.current.refreshClusters()},100)});const t=()=>{setTimeout(()=>{c.current&&d.current&&(c.current.invalidateSize(),d.current.refreshClusters(),0===d.current.getLayers().length&&l&&l.length>0&&setTimeout(()=>window.dispatchEvent(new CustomEvent("force-marker-refresh")),200))},150)};window.addEventListener("resize",t),setTimeout(()=>{c.current&&c.current.invalidateSize()},100)}})()},[r]),t.useEffect(()=>{if(c.current&&r){const e=o.divIcon({html:'<i class="fa-solid fa-location-pin user-location-icon"></i>',className:"",iconSize:[32,32],iconAnchor:[16,32]});u.current&&u.current.setLatLng([r.lat,r.lng]),m.current?m.current.setLatLng([r.lat,r.lng]):m.current=o.marker([r.lat,r.lng],{icon:e,zIndexOffset:1e3}).addTo(c.current)}},[r]);const[b,f]=t.useState(0);return t.useEffect(()=>{const e=()=>f(e=>e+1);return window.addEventListener("force-marker-refresh",e),()=>window.removeEventListener("force-marker-refresh",e)},[]),t.useEffect(()=>{d.current&&l.length&&r&&(c.current&&(c.current.removeLayer(d.current),d.current=o.markerClusterGroup({maxClusterRadius:50,spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,zoomToBoundsOnClick:!0}),c.current.addLayer(d.current)),l.forEach(e=>{var t,l;const s=e.canView||a||e.distance<=50,r="job"===e.type?"fa-briefcase":"fa-user",i="job"===e.type?"#0097A7":"#FB8C00",c=`<div class="marker-container ${e.isSponsored?"sponsored-marker":""}">\n                <div class="icon-wrapper" style="border-color: ${e.isSponsored?"#FBBF24":i};">\n                    ${e.isSponsored?'<i class="fa-solid fa-star absolute -top-2 -right-2 text-yellow-400 text-xl"></i>':""}\n                    <i class="fa-solid ${r}" style="color: ${i};"></i>\n                </div>\n                <div class="marker-label">${e.title}</div>\n            </div>`,u=o.divIcon({html:c,className:"",iconSize:[120,90],iconAnchor:[60,26]}),m=o.marker([e.location.lat,e.location.lng],{icon:u});let x;if(s){let s="";"cv"===e.type&&e.contact?s=`<div style="background-color: #fff7ed; padding: 12px; border-radius: 8px; margin-top: 12px;">\n                        <div style="font-weight: 600; color: #ea580c; margin-bottom: 6px;">İletişim Bilgileri</div>\n                        <div style="color: #ea580c; word-break: break-all; font-size: 14px;">${e.contact}</div>\n                    </div>`:"job"===e.type&&"manual"===e.source&&e.contact?s=`<div style="background-color: #f0f9ff; padding: 12px; border-radius: 8px; margin-top: 12px;">\n                        <div style="font-weight: 600; color: #1e40af; margin-bottom: 6px;">İletişim Bilgileri</div>\n                        <div style="color: #1e40af; word-break: break-all; font-size: 14px;">${e.contact}</div>\n                    </div>`:"job"===e.type&&e.applyUrl&&(s=`<a href="${e.applyUrl}" target="_blank" style="display: block; background-color: #2563eb; color: white; padding: 12px; text-align: center; border-radius: 8px; text-decoration: none; margin-top: 12px;">İlana Başvur</a>`),x=`<div class="custom-popup-container">\n                    <div style="font-size: 18px; font-weight: bold; color: #0097A7; margin-bottom: 8px;">${e.title}</div>\n                    ${"job"===e.type&&e.salary_min?`<div style="font-size: 15px; font-weight: bold; color: #059669; margin-bottom: 12px; padding: 8px; background-color: #f0fdf4; border-radius: 6px;">${e.currency||"USD"} ${(null==(t=e.salary_min)?void 0:t.toLocaleString())||"?"} - ${(null==(l=e.salary_max)?void 0:l.toLocaleString())||"?"}</div>`:""}\n                    <div style="font-size: 14px; color: #4b5563; margin-bottom: 12px;">\n                        <i class="fa-solid fa-building" style="margin-right: 8px;"></i>${e.company||"Şirket bilgisi yok"}\n                        <br><i class="fa-solid fa-location-dot" style="margin-right: 8px; margin-top: 4px;"></i>${e.address}\n                    </div>\n                    ${s}\n                </div>`}else x=`<div class="custom-popup-container text-center">\n                    <div class="font-bold text-lg text-ilan">${e.title}</div>\n                    <div class="text-base font-semibold text-gray-800">${e.company}</div>\n                    <p class="text-sm text-gray-600 my-2">Bu kayıt <b>50 km'lik ücretsiz alanınızın dışında</b> kaldığı için detayları gizlenmiştir.</p>\n                    <button id="subscribe-btn-${e.id}" class="w-full bg-green-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-600">Abonelik Seçenekleri</button>\n                </div>`;m.bindPopup(x),s||m.on("popupopen",()=>{const t=document.getElementById(`subscribe-btn-${e.id}`);t&&(t.onclick=n)}),d.current.addLayer(m)}))},[l,a,b]),t.useEffect(()=>{s&&c.current&&c.current.setView([s.lat,s.lng],16)},[s]),e.jsxs("div",{className:"relative h-full w-full",children:[e.jsx("div",{ref:i,className:"h-full w-full"}),e.jsxs("div",{className:"absolute top-4 right-4 z-[1000] flex flex-col gap-2",children:[e.jsx("button",{onClick:()=>c.current&&r&&c.current.setView([r.lat,r.lng],14),className:"bg-green-600 text-white font-semibold px-4 py-2 rounded-lg shadow-lg hover:bg-green-700",children:"Konum"}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg flex",children:[e.jsx("button",{onClick:()=>h("street"),className:"px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-l-lg",children:"Sokak"}),e.jsx("button",{onClick:()=>h("satellite"),className:"px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-r-lg border-l",children:"Uydu"})]})]})]})}function d({onFilterChange:l,setCurrentPage:s,isSubscribed:a,onSubscribeToggle:r}){const[n,i]=t.useState(""),[o,c]=t.useState("all");return e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2 flex-shrink-0",children:[e.jsx("button",{onClick:()=>{c("all"),l({type:"all",keyword:n})},className:"p-3 rounded-lg font-semibold text-sm "+("all"===o?"bg-gray-800 text-white":"bg-gray-200"),children:"Tümü"}),e.jsx("button",{onClick:()=>{c("job"),l({type:"job",keyword:n})},className:"p-3 rounded-lg font-semibold text-sm "+("job"===o?"bg-ilan text-white":"bg-gray-200"),children:"İş İlanları"}),e.jsx("button",{onClick:()=>{c("cv"),l({type:"cv",keyword:n})},className:"p-3 rounded-lg font-semibold text-sm "+("cv"===o?"bg-cv text-white":"bg-gray-200"),children:"Adaylar"})]}),e.jsxs("div",{className:"flex-grow flex gap-2",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx("input",{type:"text",placeholder:"Anahtar kelime ile ara...",value:n,onChange:e=>i(e.target.value),className:"w-full h-full p-3 pl-10 border rounded-lg"}),e.jsx("i",{className:"fa-solid fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"})]}),e.jsx("button",{onClick:async()=>{const e=await fetch(`/api/get-jobs?q=${n}&limit=1000&page=1`),t=await e.json();t.success&&(l({type:o,keyword:n,apiData:t.jobs}),s(1))},className:"bg-blue-600 text-white font-semibold px-4 rounded-lg hover:bg-blue-700",children:"Filtrele"}),e.jsx("button",{onClick:()=>{i(""),c("all"),s(1),l({type:"all",keyword:"",useCachedData:!0})},className:"bg-gray-200 text-gray-700 font-semibold px-4 rounded-lg hover:bg-gray-300",children:"Temizle"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:a,onChange:r,className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Abone Olundu"})]})]})})}const u=(e,t,l,s)=>{if(!(e&&t&&l&&s))return 1/0;const a=(l-e)*Math.PI/180,r=(s-t)*Math.PI/180,n=Math.sin(a/2)*Math.sin(a/2)+Math.cos(e*Math.PI/180)*Math.cos(l*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 6371*(2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n)))},m=t.memo(({index:t,style:l,data:s})=>{const{items:a,userLocation:r,onRowClick:n,isSubscribed:i,onPremiumClick:o}=s,c=a[t],d=u(r.lat,r.lng,c.location.lat,c.location.lng),m=i||!(d>50);return e.jsxs("div",{style:l,className:`border-b bg-white flex items-center hover:bg-gray-50 transition-colors ${m?"cursor-pointer":"opacity-70"} ${c.isSponsored?"bg-yellow-50":""}`,onClick:()=>m?n(c.location):o(),children:[e.jsx("div",{className:"w-24 px-3 py-3 flex-shrink-0",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-semibold text-white "+("job"===c.type?"bg-ilan":"bg-cv"),children:"job"===c.type?"İLAN":"Aday"}),c.isSponsored&&e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-semibold text-yellow-800 bg-yellow-200",children:"Sponsorlu"})]})}),e.jsxs("div",{className:"flex-grow px-3 py-3 min-w-0",children:[e.jsx("p",{className:"font-bold text-sm truncate",children:c.title}),e.jsx("p",{className:`text-gray-600 text-xs mt-1 truncate ${!m&&"blur-sm"}`,children:c.company||c.name||"Şirket bilgisi mevcut değil"})]}),e.jsx("div",{className:"w-20 px-3 py-3 text-right flex-shrink-0",children:e.jsxs("span",{className:`text-sm font-medium text-gray-700 ${!m&&"blur-sm"}`,children:[d.toFixed(1)," km"]})}),e.jsx("div",{className:"w-32 px-3 py-3 flex-shrink-0",children:e.jsx("span",{className:"text-xs text-gray-600 truncate block",children:c.address})}),e.jsx("div",{className:"w-24 px-3 py-3 flex-shrink-0",children:e.jsxs("div",{className:"flex gap-1 text-xs",children:[c.isOwner&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded hover:bg-blue-200 text-xs",children:"✏️"}),e.jsx("button",{className:"px-2 py-1 bg-red-100 text-red-800 rounded hover:bg-red-200 text-xs",children:"🗑️"})]}),e.jsx("button",{className:"px-2 py-1 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 text-xs",children:"⚠️"})]})})]})});const x=t.memo(function({data:t,onRowClick:l,isSubscribed:s,userLocation:a,onPremiumClick:r}){return 0===t.length?e.jsx("div",{className:"flex-grow flex items-center justify-center",children:e.jsx("p",{className:"text-center text-gray-500",children:"Filtrelerinize uygun sonuç bulunamadı."})}):e.jsxs("div",{className:"flex-grow flex flex-col bg-white",children:[e.jsxs("div",{className:"border-b bg-gray-100 flex items-center text-sm font-semibold text-gray-600",children:[e.jsx("div",{className:"w-24 px-3 py-3 flex-shrink-0",children:"Tür"}),e.jsx("div",{className:"flex-grow px-3 py-3 min-w-0",children:"Başlık / Ünvan"}),e.jsx("div",{className:"w-20 px-3 py-3 text-right flex-shrink-0",children:"Uzaklık"}),e.jsx("div",{className:"w-32 px-3 py-3 flex-shrink-0",children:"Konum"}),e.jsx("div",{className:"w-24 px-3 py-3 flex-shrink-0",children:"Aksiyonlar"})]}),e.jsx("div",{className:"flex-grow",children:t.map((n,i)=>e.jsx(m,{index:i,style:{},data:{items:t,userLocation:a,onRowClick:l,isSubscribed:s,onPremiumClick:r}},n.id))}),e.jsxs("div",{className:"border-t bg-gray-50 px-4 py-2 text-xs text-gray-600",children:["Toplam ",t.length.toLocaleString()," ilan gösteriliyor"]})]})});function p({currentPage:t,totalPages:l,onPageChange:s}){return l<=1?null:e.jsxs("div",{className:"flex justify-center items-center gap-2 mt-4",children:[e.jsx("button",{onClick:()=>s(t-1),disabled:1===t,className:"px-3 py-1 rounded-md bg-gray-200 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",children:"Önceki"}),(()=>{const e=[],s=Math.floor(3.5);if(l<=7)for(let t=1;t<=l;t++)e.push(t);else{e.push(1),t>s+1&&e.push("...");let a=Math.max(2,t-s+(t>l-s?l-t-s+1:0)),r=Math.min(l-1,t+s-(t<=s?t-s:0));for(let t=a;t<=r;t++)e.push(t);t<l-s&&e.push("..."),e.push(l)}return e})().map((l,a)=>"number"==typeof l?e.jsx("button",{onClick:()=>s(l),className:"w-8 h-8 rounded-md "+(t===l?"bg-blue-600 text-white":"bg-gray-200 hover:bg-gray-300"),children:l},a):e.jsx("span",{className:"px-2 text-gray-500",children:"..."},a)),e.jsx("button",{onClick:()=>s(t+1),disabled:t===l,className:"px-3 py-1 rounded-md bg-gray-200 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed",children:"Sonraki"})]})}function g({onAddEntry:l,userLocation:s}){const[a,r]=t.useState("job"),[n,i]=t.useState(""),[o,c]=t.useState(""),[d,u]=t.useState(""),[m,x]=t.useState(""),[p,g]=t.useState(""),[h,b]=t.useState("");return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[e.jsx("button",{onClick:()=>r("job"),className:"p-3 rounded-lg font-semibold "+("job"===a?"bg-ilan text-white":"bg-gray-200"),children:"İş İlanı"}),e.jsx("button",{onClick:()=>r("cv"),className:"p-3 rounded-lg font-semibold "+("cv"===a?"bg-cv text-white":"bg-gray-200"),children:"Özgeçmiş"})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault();let t=`${s.lat.toFixed(4)}, ${s.lng.toFixed(4)}`;try{const e=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s.lat}&lon=${s.lng}&zoom=18&addressdetails=1`),l=await e.json();if(l.display_name){const e=l.display_name.split(",").map(e=>e.trim());t=e.length>2?`${e[0]}, ${e[e.length-1]}`:l.display_name.substring(0,50)}}catch(f){}const r={id:`manual-${Date.now()}`,type:a,title:n,description:p,location:{lat:s.lat,lng:s.lng},address:t,source:"manual",postedDate:(new Date).toISOString(),applyUrl:null,contact:h};"job"===a?(r.company=o,r.salary_min=parseInt(d),r.salary_max=parseInt(m),r.salary={min:parseInt(d),max:parseInt(m),currency:"TRY",period:"Aylık"},r.employmentType="Tam zamanlı",r.category="Genel"):r.name=o,l(r),i(""),c(""),u(""),x(""),g(""),b("")},className:"flex-grow flex flex-col",children:[e.jsx("div",{className:"space-y-3",children:"job"===a?e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",placeholder:"İlan Başlığı (örn: Yazılım Geliştiricisi)",value:n,onChange:e=>i(e.target.value),className:"w-full p-2 border rounded-md",required:!0}),e.jsx("textarea",{placeholder:"Açıklama",value:p,onChange:e=>g(e.target.value),className:"w-full p-2 border rounded-md h-24",required:!0}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",placeholder:"Min Maaş",value:d,onChange:e=>u(e.target.value),className:"w-1/2 p-2 border rounded-md",required:!0}),e.jsx("input",{type:"number",placeholder:"Max Maaş",value:m,onChange:e=>x(e.target.value),className:"w-1/2 p-2 border rounded-md",required:!0})]}),e.jsx("input",{type:"text",placeholder:"Şirket Adı",value:o,onChange:e=>c(e.target.value),className:"w-full p-2 border rounded-md",required:!0}),e.jsx("input",{type:"text",placeholder:"İletişim Bilgileri (E-posta veya Telefon)",value:h,onChange:e=>b(e.target.value),className:"w-full p-2 border rounded-md",required:!0})]}):e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",placeholder:"Ad Soyad",value:o,onChange:e=>c(e.target.value),className:"w-full p-2 border rounded-md",required:!0}),e.jsx("input",{type:"text",placeholder:"Ünvan (örn: Proje Yöneticisi)",value:n,onChange:e=>i(e.target.value),className:"w-full p-2 border rounded-md",required:!0}),e.jsx("textarea",{placeholder:"Açıklama / Yetenek Özeti",value:p,onChange:e=>g(e.target.value),className:"w-full p-2 border rounded-md h-40",required:!0}),e.jsx("input",{type:"text",placeholder:"İletişim Bilgileri (E-posta veya Telefon)",value:h,onChange:e=>b(e.target.value),className:"w-full p-2 border rounded-md",required:!0})]})}),e.jsx("button",{type:"submit",className:"w-full p-3 rounded-lg font-bold text-white bg-blue-600 hover:bg-blue-700 mt-auto",children:"Ekle"})]})]})}function h({onClose:t}){return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-[2000]",children:e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-2xl text-center max-w-sm",children:[e.jsx("i",{className:"fa-solid fa-lock text-5xl text-yellow-500 mb-4"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Premium Özellik"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Bu kaydın tüm detaylarını görmek ve 50 km dışındaki tüm fırsatlara erişmek için abonelik planlarımızı inceleyin."}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{className:"w-full bg-green-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-600",children:"Abonelik Seçeneklerini Gör"}),e.jsx("button",{onClick:t,className:"w-full bg-gray-200 text-gray-700 font-bold py-3 px-4 rounded-lg hover:bg-gray-300",children:"Kapat"})]})]})})}const b=[];function f(){const[l,s]=t.useState(b),[a,r]=t.useState([]),[o,m]=t.useState([]),[f,y]=t.useState({type:"all",keyword:""}),[v,j]=t.useState(window.innerWidth<768),[w,k]=t.useState(null),[N,C]=t.useState(!1),[S,L]=t.useState(!1),[z,$]=t.useState(1),[E,P]=t.useState(!1),[M,T]=t.useState(!1),[A,F]=t.useState(!1),[B,O]=t.useState(!1),[q,D]=t.useState(null);t.useEffect(()=>{navigator.geolocation.getCurrentPosition(e=>{D({lat:e.coords.latitude,lng:e.coords.longitude})},e=>{D({lat:41.01,lng:28.97})})},[]);const G=t.useCallback(e=>e.map(e=>({id:`db-${e.id}`,type:"job",title:e.title,company:e.company||"Şirket Belirtilmemiş",name:e.company,location:{lat:parseFloat(e.lat),lng:parseFloat(e.lon)},address:`${e.city||""}, ${e.country||""}`.replace(/^,\s*|,\s*$/g,""),salary_min:e.salary_min,salary_max:e.salary_max,currency:e.currency,applyUrl:"manual"===e.source?null:e.url,contact:"manual"===e.source?e.contact:null,source:e.source||"unknown",postedDate:e.created_at})).filter(e=>e.location.lat&&e.location.lng),[]);t.useEffect(()=>{if(!(null==q?void 0:q.lat)||!(null==q?void 0:q.lng))return;(async()=>{var e;try{const t=await fetch("/api/get-jobs?limit=1000&page=1"),l=await t.json();if(l.success&&(null==(e=l.jobs)?void 0:e.length)>0){const e=G(l.jobs),t={};e.forEach(e=>{const l=e.address.split(",").pop().trim();t[l]=(t[l]||0)+1}),s(e),r(e)}else s([])}catch(t){s([])}})()},[q,G]),t.useEffect(()=>{const e=()=>{j(window.innerWidth<768)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const I=t.useMemo(()=>{if(!q||0===l.length)return[];if("all"===f.type&&""===f.keyword&&o.length>0)return o;performance.now();const e=f.keyword?f.keyword.toLowerCase():"",t=l.filter(t=>{var l,s,a;if("all"!==f.type&&t.type!==f.type)return!1;if(e){const r=null==(l=t.title)?void 0:l.toLowerCase().includes(e),n=null==(s=t.company)?void 0:s.toLowerCase().includes(e),i=null==(a=t.name)?void 0:a.toLowerCase().includes(e);if(!r&&!n&&!i)return!1}return!0}),s=1e3,r=[];for(let l=0;l<t.length;l+=s){const e=t.slice(l,l+s).map(e=>{const t=u(q.lat,q.lng,e.location.lat,e.location.lng);return{...e,distance:t,canView:E||t<=50}});r.push(...e),t.length}r.sort((e,t)=>e.isSponsored&&!t.isSponsored?-1:!e.isSponsored&&t.isSponsored?1:e.canView&&!t.canView?-1:!e.canView&&t.canView?1:e.distance-t.distance),"all"===f.type&&""===f.keyword&&0===o.length&&l.length===a.length&&m(r);performance.now();return r},[l,f,E,q,o,a]),R=t.useMemo(()=>{const e=75*(z-1),t=e+75;return I.slice(e,t)},[z,I]),_=Math.ceil(I.length/75),V=t.useCallback(e=>{const t={...e,id:Date.now(),isOwner:!0,isSponsored:!1};s(e=>[t,...e]),v&&L(!1)},[v]),U=t.useCallback(e=>{k(e),v&&C(!1)},[v]),Y=t.useCallback(e=>{if(e.clearData){const t=G(e.clearData);s(t),y({type:"all",keyword:""})}else if(e.useCachedData)y({type:"all",keyword:""});else if(e.apiData){const t=G(e.apiData);s(t),y({type:e.type,keyword:e.keyword})}else t.startTransition(()=>{y(e)})},[G]),K=t.useCallback(()=>T(!0),[]);return q?e.jsxs(e.Fragment,{children:[M&&e.jsx(h,{onClose:()=>T(!1)}),e.jsx(i,{isOpen:A,onClose:()=>F(!1),userType:"company",title:"Firma Girişi",color:"ilan"}),e.jsx(i,{isOpen:B,onClose:()=>O(!1),userType:"individual",title:"Aday Girişi",color:"cv"}),e.jsx(n,{onFirmaLogin:()=>F(!0),onAdayLogin:()=>O(!0)}),v?e.jsxs("div",{className:"h-[calc(100vh-60px)] w-full relative",children:[e.jsx(c,{data:I,selectedLocation:w,isSubscribed:E,userLocation:q,onPremiumClick:K}),e.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-[1000] flex gap-4",children:e.jsxs("button",{onClick:()=>C(!0),className:"bg-white text-gray-800 font-bold py-3 px-6 rounded-full shadow-lg flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-list"})," Filtrele & Listele"]})}),e.jsx("div",{className:"absolute top-4 right-4 z-[1000]",children:e.jsx("button",{onClick:()=>L(!0),className:"bg-blue-600 text-white w-14 h-14 rounded-full shadow-lg flex items-center justify-center text-2xl",children:e.jsx("i",{className:"fa-solid fa-plus"})})}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 z-[1001] bg-white rounded-t-2xl shadow-2xl p-4 bottom-sheet "+(N?"transform translate-y-0":"transform translate-y-full"),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Sonuçlar"}),e.jsx("button",{onClick:()=>C(!1),className:"text-gray-500 text-2xl",children:"×"})]}),e.jsx(d,{onFilterChange:Y,setCurrentPage:$,isSubscribed:E,onSubscribeToggle:()=>P(!E)}),e.jsx(x,{data:R,onRowClick:U,isSubscribed:E,userLocation:q,onPremiumClick:K}),e.jsx(p,{currentPage:z,totalPages:_,onPageChange:$})]}),S&&e.jsxs("div",{className:"absolute top-0 left-0 w-full h-full bg-gray-100 z-[1002] p-4 overflow-y-auto",children:[e.jsx("div",{className:"flex justify-end items-center mb-4",children:e.jsx("button",{onClick:()=>L(!1),className:"text-gray-500 text-2xl",children:"×"})}),e.jsx(g,{onAddEntry:V,userLocation:q})]})]}):e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex h-[70vh] bg-white",children:[e.jsx("div",{className:"w-[35%] h-full p-4 bg-gray-50 flex flex-col",children:e.jsx(g,{onAddEntry:V,userLocation:q})}),e.jsx("div",{className:"w-[65%] h-full",children:e.jsx(c,{data:I,selectedLocation:w,isSubscribed:E,userLocation:q,onPremiumClick:K})})]}),e.jsxs("div",{className:"bg-white border-t",children:[e.jsx("div",{className:"p-4 bg-gray-50 border-b",children:e.jsx(d,{onFilterChange:Y,setCurrentPage:$,isSubscribed:E,onSubscribeToggle:()=>P(!E)})}),e.jsxs("div",{className:"p-4",children:[e.jsx(x,{data:R,onRowClick:U,isSubscribed:E,userLocation:q,onPremiumClick:K}),e.jsx("div",{className:"mt-6 mb-8",children:e.jsx(p,{currentPage:z,totalPages:_,onPageChange:$})})]})]})]})]}):e.jsx("div",{className:"h-full w-full flex justify-center items-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fa-solid fa-spinner fa-spin text-4xl text-blue-600"}),e.jsx("p",{className:"mt-4 text-gray-700",children:"Konumunuz alınıyor..."})]})})}l.createRoot(document.getElementById("root")).render(e.jsxs(s.StrictMode,{children:[e.jsx(f,{}),e.jsx(a,{}),e.jsx(r,{})]}));
